# Maintainer: protonesso <nagakamira@gmail.com>
# Contributor: protonesso <nagakamira@gmail.com>

pkgname=flex
pkgver=2.6.4
pkgrel=1
pkgdesc="A tool for generating text-scanning programs"
arch=('riscv32' 'riscv64')
url="https://github.com/westes/flex"
license=('custom')
depends=('musl' 'm4')
makedepends=('bison')
source=("https://github.com/westes/flex/releases/download/v$pkgver/$pkgname-$pkgver.tar.gz")
md5sums=('2882e3179748cc9f9c23ec593d6adc8d')

prepare() {
	cd $pkgname-$pkgver
cat > config.cache << EOF
ac_cv_func_malloc_0_nonnull=yes
ac_cv_func_realloc_0_nonnull=yes
EOF
}

build() {
	cd $pkgname-$pkgver
	./configure \
		--prefix=/usr \
		--cache-file=config.cache \
		--build=$XHOST \
		--host=$XTARGET
	make
}

package() {
	cd $pkgname-$pkgver
	make DESTDIR=$pkgdir install
}
