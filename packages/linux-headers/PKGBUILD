# Maintainer: protonesso <nagakamira@gmail.com>
# Contributor: protonesso <nagakamira@gmail.com>

pkgname=linux-headers
apkgver=for-next
pkgver=${apkgver/-/+}
pkgrel=1
pkgdesc="Header files and scripts for building modules for Linux kernel"
arch=('riscv32' 'riscv64')
url="https://www.kernel.org/"
license=('GPL')
options=('!strip')
source=("https://kernel.googlesource.com/pub/scm/linux/kernel/git/palmer/riscv-linux/+archive/$apkgver.tar.gz")
md5sums=('SKIP')

prepare() {
	make mrproper
}

package() {
	case $CARCH in
		riscv*)
			export XKARCH="riscv"
			;;
		*)
			echo "Architecture is not set or is not supported"
			exit 1
	esac

	make ARCH=$XKARCH INSTALL_HDR_PATH=$pkgdir/usr headers_install
	find $pkgdir/usr/include \( -name .install -o -name ..install.cmd \) -delete
}
