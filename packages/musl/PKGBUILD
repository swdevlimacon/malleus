# Maintainer: protonesso <nagakamira@gmail.com>
# Contributor: protonesso <nagakamira@gmail.com>

pkgname=musl
pkgver=riscv
pkgrel=1
pkgdesc="Lightweight implementation of C standard library"
arch=('riscv32' 'riscv64')
url="http://www.musl-libc.org/"
license=('MIT')
options=('staticlibs' '!buildflags')
source=("https://github.com/michaelforney/musl/archive/$pkgver.tar.gz")
md5sums=('SKIP')

build() {
	unset HOSTCC HOSTCXX

	cd $pkgname-$pkgver
	./configure \
		CROSS_COMPILE=$XTARGET- \
		--prefix=/usr \
		--syslibdir=/usr/lib \
		--build=$XHOST \
		--host=$XTARGET \
		--target=$XTARGET
	make
}

package() {
	unset HOSTCC HOSTCXX

	cd $pkgname-$pkgver
	make DESTDIR=$pkgdir install

	mkdir -p $pkgdir/usr/bin/
	ln -sf ../lib/libc.so $pkgdir/usr/bin/ldd
}
